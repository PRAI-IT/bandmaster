## Капельмейстер


### Установка


    pip install fastapi
    pip install uvicorn
    pip install turbo-alignment

    PyTorch https://pytorch.org/get-started/locally/


### Файлы и дирректории


settings.ini - конфигурационный файл
main.py - скрипт для запуска API
/wandb - директория хранения логов и статистики обучения модели
/train_output - директория дообученных моделей
/sft - директория подготовки датасета к обучению модели
/dpo - директория подготовки датасета к обучению модели
/promt - директория тестовых промтов
/lib/tlite - класс подключения модели и обработки ответа
/lib/yandexGPT - скрипт подготовки данных для датасета
/file/ - файлы с запросами из вордстата
/dataset/ - файлы с подготовленными данными


### Запуск Api


uvicorn main:app --host 0.0.0.0 --port 0000

укажите свой ip и порт, можете не указывать тогда api развернется на стандартном порту

При первом запуске скачацется модель t-bank-ai/T-lite-instruct-0.1, если хотите подключить свою или 
дообученную нужно настроить в файле settings.ini


### Подготовка датасета


В конфигурационном файле указываем настройки
и переходим к файлу /lib/yandexGPT.py
в ем мы можем указать из какого файла мы будем брать запросы и куда сохраним данные

Этап подготовки данных:

1. На основе запроса просим бота создать промт по примеру
2. Просим подготовить ответ под промт
3. Планировалось подготовить ответ из библиотеки t-bank-ai/T-lite-instruct-0.1(как пример не удачного)


### Дообучение модели sft


Запускаем
python sft/sft.py
После выполнения появятся 2 файла
train.jsonl - Набор данных для дообучения модели
val.jsonl - Надор данных для валидации

настроим конфигурационный файл sft/sft.json
для работы с библиотекой turbo_alignment, нужно зарегистрироваться на https://wandb.ai
В файле нужно указать:
1. project_name - название проекта, если проекта нет он создаться сам
2. entity - название компании на которую вы зарегистрировались
3. fp16 и bf16: нужно настроит в зависимости от видеокарты


Дла дообучения модели выполним команду
python -m turbo_alignment train_sft --experiment_settings_path sft/sft.json


### Дообучение модели dpo


Пробовали но не успели






